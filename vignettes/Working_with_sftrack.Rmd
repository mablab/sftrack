---
title: "3. Introduction to an sftrack/sftraj object"
output:
  pdf_document: default
  html_document: default
vignette: |
  %\VignetteIndexEntry{3. Working with an sftrack}
   %\VignetteEncoding{UTF-8}
   %\VignetteEngine{knitr::rmarkdown}
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
devtools::load_all("/home/matt/r_programs/sftrack")
#library(sftrack)

```
### Some basic functionality of sf_track and sf_traj objects
##### print  
`print()` prints out the type of object as well as specific data on the sf_track object. Additionally you can supply the number of rows or columns you'd like to display with arguments `n_row` and `n_col`. When using `n_col` the display will show the `burst` and `geometery` fields as well as any other columns starting from column 1 until `#columns + 2 = n_col`. If neither is provided than print just uses default values in the global options. `ncol` and `nrow` are optional arguments, defaults to data.frame defaults.

```{r}
# Make tracks from raw data
data <- read.csv(system.file('extdata/raccoon_data.csv', package='sftrack'))
data$month <- as.POSIXlt(data$acquisition_time)$mon+1

data$time <- as.POSIXct(data$acquisition_time, tz='EST')
coords = c('longitude','latitude')
burst = list(id = data$sensor_code, month = as.POSIXlt(data$acquisition_time)$mon+1)
time = 'time'
error = 'fix'
crs = '+init=epsg:4326'
my_sftrack <- as_sftrack(data = data, coords = coords, burst = burst, time = time, error = error, crs = crs)
my_sftraj <- as_sftraj(data = data, coords = coords, burst = burst, time = time, error = error, crs = crs)
print(my_sftrack,5,10)
```

##### summary  
`summary()` works as youd normally expect for a data.frame, except it displays the burst column as a count of each active_burst combination.  
```{r}
summary(my_sftrack)
```

##### summary_sftrack  
`summary_sftrack()` is a special summary function specific for sftrack objects. It summarizes the data based on the beginning and end of each burst as well as the total distance of the burst. This function uses `st_length` from the `sf` package and therefore outputs in units of the crs. In this example the distance is in degrees distance.
```{r}
summary_sftrack(my_sftrack)

```

You can also trigger this function by using `summary(data, stats = TRUE)`

```{r}
summary(my_sftrack, stats = TRUE)
```

An sftrack object attempts to act like a data.frame and sf whenever appropriate. Because of this you can subset an sftrack object as you would a data.frame. Except, like sf, it attempts to retain the geometry, burst, and time columns, in order to maintain sftrack status.

In this way row subsetting is very straight forward, as each row represents an individual point in time.

```{r}

my_sftrack[1:10,]
```

Subsetting by column however, sftrack attempts to retain imporatnt columns by default. THis mirrors sf functionality.

```{r}

my_sftrack[1:3,c(1:3)]
```
}

To turn off this feature, you just use the drop = T argument, again a lot like sf.

```{r}
my_sftrack[1:3,c(1:3), drop = TRUE]
```


sftrajs work nearly the same, however because they are a step model where in the steps are modeled as step1 (t1 ->t2) its important to note that subsetting will not automatically calculate any steps for you.

If your subsetting will also change your steps, creating new end points for steps, then you can recalculate using `step_recalc()`

```{r}
plot(my_sftraj, main ='original', axes = T)
new_traj <- my_sftraj[seq(10,nrow(my_sftraj),10),]

plot(new_traj, main ='before recalculation', axes = T)

plot(step_recalc(new_traj),  main ='after recalculation', axes = T)
```
